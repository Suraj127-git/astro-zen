---
import type { HeroProps } from "@types";
type Props = HeroProps;

const { name, specialty, summary, email, tagline, stats, availability } = Astro.props;
---

<section class="min-h-screen pt-0 pb-20 md:pb-32 relative overflow-hidden flex items-center" id="hero">
  <!-- Optimized background elements with hardware acceleration -->
  <div class="absolute inset-0 overflow-hidden pointer-events-none hero-bg-container">
    <div class="hero-bg-gradient absolute top-20 -right-40 w-96 h-96 bg-primary/10 rounded-full blur-3xl will-change-transform"></div>
    <div class="hero-bg-gradient-2 absolute bottom-20 -left-40 w-80 h-80 bg-blue-500/10 rounded-full blur-3xl will-change-transform"></div>
    <div class="absolute inset-0 bg-gradient-to-b from-transparent via-transparent to-bg"></div>
  </div>

  <!-- Content -->
  <div class="relative z-10 w-full flex justify-center">
    <div class="max-w-5xl text-center px-4">
      <!-- Availability Badge -->
      {availability && (
        <div class="inline-flex items-center gap-2 px-4 py-2 mb-8 rounded-full border border-primary/30 bg-primary/5 hero-availability backdrop-blur-sm will-change-transform">
          <span class={`w-2 h-2 rounded-full ${availability.status === 'available' ? 'bg-green-500 animate-pulse' : 'bg-yellow-500'}`}></span>
          <span class="text-sm font-medium text-secondary">{availability.text}</span>
        </div>
      )}

      <!-- Main Headline - Simplified for performance -->
      {tagline && (
        <h2 class="text-xl sm:text-2xl md:text-3xl font-medium text-primary mb-6 hero-tagline tracking-tight will-change-transform">
          {tagline}
        </h2>
      )}

      <!-- Name - Optimized single animation -->
      <h1 class="text-5xl sm:text-6xl md:text-7xl lg:text-8xl font-serif mb-4 text-text font-bold tracking-tightest hero-name leading-tight will-change-transform">
        <span class="inline-block hero-name-container">
          {name.split(' ').map((word) => (
            <span class="inline-block mr-4 hero-name-word">
              {word}
            </span>
          ))}
        </span>
      </h1>

      <!-- Specialty/Role -->
      <p class="text-3xl sm:text-4xl md:text-5xl font-serif text-text/90 font-semibold tracking-tight mb-8 hero-specialty will-change-transform">
        {specialty}
      </p>

      <!-- Summary/Description -->
      <p class="text-lg md:text-xl text-secondary font-normal mb-10 max-w-3xl mx-auto hero-summary leading-relaxed will-change-transform">
        {summary}
      </p>

      <!-- Stats Section -->
      {stats && stats.length > 0 && (
        <div class="grid grid-cols-2 md:grid-cols-4 gap-6 md:gap-8 mb-12 hero-stats max-w-4xl mx-auto">
          {stats.map((stat, index) => (
            <div class="hero-stat-item will-change-transform" data-stat-index={index}>
              <div class="text-3xl md:text-4xl font-bold text-primary mb-1 font-serif">
                {stat.value}
              </div>
              <div class="text-sm md:text-base text-secondary font-medium">
                {stat.label}
              </div>
            </div>
          ))}
        </div>
      )}

      <!-- CTA Buttons - Simplified animations -->
      <div class="flex gap-4 flex-wrap items-center justify-center">
        <a
          class="group text-sm md:text-base py-4 px-8 md:py-5 md:px-10 text-white inline-flex items-center gap-3 font-semibold leading-5 bg-gradient-to-r from-primary to-blue-500 rounded-full hero-cta relative overflow-hidden shadow-lg shadow-primary/30 hover:shadow-xl hover:shadow-primary/40 transition-all duration-300 will-change-transform"
          href={`mailto:${email}`}
        >
          <span class="relative z-10">Let's Work Together</span>
          <svg class="w-5 h-5 relative z-10 transition-transform group-hover:translate-x-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M13 7l5 5m0 0l-5 5m5-5H6"/>
          </svg>
          <div class="absolute inset-0 bg-gradient-to-r from-blue-500 to-primary opacity-0 group-hover:opacity-100 transition-opacity duration-300"></div>
        </a>

        <a
          href="#projects"
          class="group text-sm md:text-base py-4 px-8 md:py-5 md:px-10 text-text inline-flex items-center gap-3 font-semibold leading-5 border-2 border-border rounded-full hover:bg-secondary/10 hover:border-border transition-all duration-300 hero-secondary-cta backdrop-blur-sm will-change-transform"
        >
          <span>View My Work</span>
          <svg class="w-5 h-5 transition-transform group-hover:translate-y-0.5" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M19 14l-7 7m0 0l-7-7m7 7V3"/>
          </svg>
        </a>

        <a
          href="#experience"
          class="group text-sm md:text-base py-4 px-8 md:py-5 md:px-10 text-secondary hover:text-text inline-flex items-center gap-2 font-medium transition-all duration-300 hero-tertiary-cta will-change-transform"
        >
          <span>View Experience</span>
          <svg class="w-4 h-4 transition-transform group-hover:translate-x-1" fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M9 5l7 7-7 7"/>
          </svg>
        </a>
      </div>
    </div>
  </div>

  <!-- Scroll indicator -->
  <div class="absolute bottom-10 left-1/2 -translate-x-1/2 scroll-indicator will-change-transform">
    <div class="w-6 h-10 border-2 border-border/50 rounded-full flex justify-center">
      <div class="w-1 h-2 bg-primary rounded-full mt-2 animate-bounce"></div>
    </div>
  </div>
</section>

<script>
  // Optimized hero animation with performance monitoring
  async function initHeroAnimation() {
    try {
      const prefersReducedMotion = window.matchMedia("(prefers-reduced-motion: reduce)").matches;
      if (prefersReducedMotion) {
        // Ensure content is visible without animations
        document.querySelectorAll('.hero-name-word, .hero-specialty, .hero-summary, .hero-stat-item, .hero-cta, .hero-secondary-cta, .hero-tertiary-cta').forEach(el => {
          (el as HTMLElement).style.opacity = '1';
          (el as HTMLElement).style.transform = 'none';
        });
        return;
      }

      const gsap = (await import('gsap')).default;
      
      const heroSection = document.getElementById('hero');
      if (!heroSection) return;

      // Apply hardware acceleration only within Hero section
      heroSection.querySelectorAll('.will-change-transform').forEach(el => {
        (el as HTMLElement).style.transform = 'translateZ(0)';
        (el as HTMLElement).style.willChange = 'transform';
      });

      // Optimized timeline with fewer animations
      const tl = gsap.timeline({ 
        defaults: { 
          ease: "power2.out" // Simplified easing
        },
        onComplete: () => {
          // Cleanup after animation completes
          heroSection.querySelectorAll('.will-change-transform').forEach(el => {
            (el as HTMLElement).style.willChange = 'auto';
          });
        }
      });

      // Simplified entrance animations - single timeline, fewer properties
      const availability = document.querySelector('.hero-availability');
      if (availability) {
        tl.from(availability, {
          y: -20,
          opacity: 0,
          duration: 0.4, // Faster animation
        }, 0.1);
      }

      // Simplified name animation - no character-by-character
      const nameWords = document.querySelectorAll('.hero-name-word');
      if (nameWords.length > 0) {
        tl.from(nameWords, {
          y: 30,
          opacity: 0,
          duration: 0.5,
          stagger: 0.1,
        }, 0.2);
      }

      // Specialty animation
      const specialty = document.querySelector('.hero-specialty');
      if (specialty) {
        tl.from(specialty, {
          y: 20,
          opacity: 0,
          duration: 0.4,
        }, 0.3);
      }

      // Summary animation
      const summary = document.querySelector('.hero-summary');
      if (summary) {
        tl.from(summary, {
          y: 20,
          opacity: 0,
          duration: 0.4,
        }, 0.4);
      }

      // Stats animation - optimized
      const statItems = document.querySelectorAll('.hero-stat-item');
      if (statItems.length > 0) {
        tl.from(statItems, {
          y: 20,
          opacity: 0,
          duration: 0.3,
          stagger: 0.05,
        }, 0.5);
      }

      // Button animations - simplified
      const buttons = [
        document.querySelector('.hero-cta'),
        document.querySelector('.hero-secondary-cta'),
        document.querySelector('.hero-tertiary-cta')
      ].filter(Boolean);

      if (buttons.length > 0) {
        tl.from(buttons, {
          y: 20,
          opacity: 0,
          duration: 0.3,
          stagger: 0.1,
        }, 0.6);
      }

      // Scroll indicator
      const scrollIndicator = document.querySelector('.scroll-indicator');
      if (scrollIndicator) {
        tl.from(scrollIndicator, {
          y: -10,
          opacity: 0,
          duration: 0.3,
        }, 0.8);
      }

    } catch (e) {
      console.error("Hero animation error:", e);
      // Fallback: ensure content is visible
      document.querySelectorAll('.hero-name-word, .hero-specialty, .hero-summary, .hero-stat-item, .hero-cta, .hero-secondary-cta, .hero-tertiary-cta').forEach(el => {
        (el as HTMLElement).style.opacity = '1';
      });
    }
  }

  // Initialize with performance monitoring
  if (document.readyState === 'loading') {
    document.addEventListener('DOMContentLoaded', initHeroAnimation);
  } else {
    initHeroAnimation();
  }
</script>