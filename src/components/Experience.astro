---
import Section from "./Section.astro";
import type { ExperienceProps } from "@types";

interface Props {
  experience: ExperienceProps[];
}

const { experience } = Astro.props;
---

<Section text="Work Experience" href="experience">
  {
    experience.map(({ company, position, startDate, endDate, summary }, index) => (
      <div class="mb-10 experience-item" data-index={index}>
        <h3 class="text-2xl font-serif font-semibold text-white mb-1.5">
          {company}
        </h3>
        <p class="text-primary font-medium mb-4">
          {position} â€¢ {startDate} - {endDate}
        </p>
        <p class="text-neutral">{summary}</p>
      </div>
    ))
  }
</Section>

<script>
  async function animateExperience() {
    const gsap = (await import('gsap')).default;
    const ScrollTrigger = (await import('gsap/ScrollTrigger')).default;
    
    gsap.registerPlugin(ScrollTrigger);

    gsap.from(".experience-item", {
      scrollTrigger: {
        trigger: ".experience-item",
        start: "top 80%",
        toggleActions: "play none none reverse"
      },
      y: 50,
      opacity: 0,
      duration: 0.8,
      stagger: {
        amount: 0.5,
        from: "start"
      }
    });
  }

  document.addEventListener('DOMContentLoaded', animateExperience);
</script>
